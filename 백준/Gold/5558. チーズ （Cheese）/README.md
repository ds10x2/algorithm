# [Gold V] チーズ (Cheese) - 5558 

[문제 링크](https://www.acmicpc.net/problem/5558) 

### 성능 요약

메모리: 6912 KB, 시간: 56 ms

### 분류

너비 우선 탐색, 그래프 이론, 그래프 탐색

### 제출 일자

2024년 3월 30일 14:56:42

### 문제 설명

<p>今年も JOI 町のチーズ工場がチーズの生産を始め，ねずみが巣から顔を出した．JOI 町は東西南北に区画整理されていて，各区画は巣，チーズ工場，障害物，空き地のいずれかである．ねずみは巣から出発して全てのチーズ工場を訪れチーズを 1 個ずつ食べる．</p>

<p>この町には，N 個のチーズ工場があり，どの工場も１種類のチーズだけを生産している．チーズの硬さは工場によって異なっており，硬さ 1 から N までのチーズを生産するチーズ工場がちょうど 1 つずつある．</p>

<p>ねずみの最初の体力は 1 であり，チーズを 1 個食べるごとに体力が 1 増える．ただし，ねずみは自分の体力よりも硬いチーズを食べることはできない．</p>

<p>ねずみは，東西南北に隣り合う区画に 1 分で移動することができるが，障害物の区画には入ることができない．チーズ工場をチーズを食べずに通り過ぎることもできる．すべてのチーズを食べ終えるまでにかかる最短時間を求めるプログラムを書け．ただし，ねずみがチーズを食べるのにかかる時間は無視できる．</p>

<p>
 올해도 JOI 마을의 치즈 공장이 치즈 생산을 시작하자 쥐가 모습을 드러냈다. JOI 마을은 동서남북으로 구역이 나누어져 있고, 각 구역은 쥐의 소굴, 치즈 공장, 장애물, 비어있는 공간 중 하나로 구성되어 있다. 쥐는 소굴에서 출발하여 모든 치즈공장을 돌면서 치즈를 한개씩 먹는다.
</p>

<p>
 이 마을에는 N개의 치즈 공장이 있고 모든 치즈 공장이 1개 분량의 치즈만을 생산하고 있다. 치즈의 단단한 정도는 공장마다 다르며, 1부터 N까지의 단단한 정도를 가진 치즈를 생산하는 공장이 각 하나씩 있다.
</p>

<p>
 쥐의 초기 체력은 1이며 치즈를 하나씩 먹을 때마다 체력이 1씩 증가한다. 다만, 쥐는 자신의 체력보다 단단한 치즈를 먹을 수 없다.
</p>

<p>
 쥐는 동서남북에 인접한 구역으로 이동할 수 있고 1분이 소요되지만, 장애물이 있는 곳에는 이동할 수 없다. 치즈를 먹지 않고 치즈 공장을 통과하는 것도 가능하다. 모든 치즈를 먹기 위해 걸리는 최소 시간을 구하는 프로그램을 작성하라. 다만, 쥐가 치즈를 먹는 시간은 무시한다.
</p>

### 입력 

 <p>入力は H+1 行ある．1 行目には 3 つの整数 H，W，N (1 ≦ H ≦ 1000，1 ≦ W ≦ 1000，1 ≦ N ≦ 9) がこの順に空白で区切られて書かれている．2 行目から H+1 行目までの各行には，'S'，'1', '2', ..., '9'，'X'，'.' からなる W 文字の文字列が書かれており，各々が各区画の状態を表している．北から i 番目，西から j 番目の区画を (i,j) と記述することにすると (1 ≦ i ≦ H, 1 ≦ j ≦ W)，第 i+1 行目の j 番目の文字は，区画 (i,j) が巣である場合は 'S' となり，障害物である場合は 'X' となり，空き地である場合は '.' となり，硬さ 1, 2, ..., 9 のチーズを生産する工場である場合はそれぞれ '1', '2', ..., '9' となる．入力には巣と硬さ 1, 2, ..., N のチーズを生産する工場がそれぞれ 1 つずつある．他のマスは障害物または空き地であることが保証されている．ねずみは全てのチーズを食べられることが保証されている．</p>

<p>
입력은 H+1줄에 걸쳐 이루어진다. 첫번째 줄에는 H, W, N (1 ≦ H ≦ 1000，1 ≦ W ≦ 1000，1 ≦ N ≦ 9)이 공백으로 나누어져 입력된다. 두번째 줄부터 H+1번째 줄까지는 각 줄마다 'S', '1', '2',...'9', 'X', '.'가 W개만큼 공백으로 나누어져 입력된다. 북쪽에서부터 i번째, 서쪽에서부터 j번째 구역을 (i, j)라고 표시한다고 하자(1 ≦ i ≦ H, 1 ≦ j ≦ W). 그러므로 입력의 i+1번째 줄, j번째 문자가 (i, j)구역을 의미하게 된다. 쥐가 출발하는 집은 'S', 장애물은 'X', 비어있는 공간은 '.'로 입력되며 '1','2'...'9'는 각 치즈 공장이 생산하는 치즈의 강도를 의미한다. 'S'와 '1','2',...'9'는 하나씩만 입력되며 나머지는 '.'와 'X'로 채워져있다. 쥐가 모든 치즈를 먹을 수 있음이 보장된다.
</p>

### 출력 

 <p>すべてのチーズを食べ終えるまでにかかる最短時間（分）を表す整数を 1 行で出力せよ．</p>

 <p>모든 치즈를 먹는 데 걸리는 최소 시간을 한줄로 출력하시오.</p>

